# repositories/habit_repository.py

from database import get_pool

# =====================================================
# üîπ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –ø—Ä–∏–≤—ã—á–∫–∏
#     –≠—Ç–æ—Ç —Å–ª–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.
#     - –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å—ã
#     - –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫–∏
#     - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram –∏–ª–∏ FSM
# =====================================================
async def insert_habit(user_id: int, name: str, desc: str, days: int, diff: int):
    """
    –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –ø—Ä–∏–≤—ã—á–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É habits.

    –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
        user_id (int): –í–ª–∞–¥–µ–ª–µ—Ü –ø—Ä–∏–≤—ã—á–∫–∏
        name (str): –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏
        desc (str): –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏
        days (int): –ù–∞ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±–µ—Ä—ë—Ç—Å—è –ø—Ä–∏–≤—ã—á–∫–∞
        diff (int): –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (1‚Äì3)

    –õ–æ–≥–∏–∫–∞:
        - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å –±–∞–∑–æ–π
        - –Ω–∏–∫–∞–∫–∏—Ö Telegram-–æ–±—ä–µ–∫—Ç–æ–≤
        - –Ω–∏–∫–∞–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
        - –Ω–∏–∫–∞–∫–∏—Ö FSM
        - —Ç–æ–ª—å–∫–æ SQL
    """

    pool = await get_pool()
    async with pool.acquire() as conn:
        await conn.execute(
            """
            INSERT INTO habits 
                (user_id, name, description, days, confirm_type, is_challenge, difficulty)
            VALUES 
                ($1, $2, $3, $4, 'media', FALSE, $5)
            """,
            user_id, name, desc, days, diff
        )
